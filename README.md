# 삼수생이 만든 수능 국어 GPT

## Overview
'GPT-4가 고작 수능 국어 3등급이라고?'라는 의문에서 시작된 프로젝트입니다.
결론적으로 23 수능 국어에서 "**96점, 1등급**"을 달성하였습니다.

언론이나 유튜브 등에서는 수능 국어를 일련의 프롬프트 엔지니어링 없이 풀었을 것입니다.
저희는 프롬프트 엔지니어링과 함께라면, GPT-4도 수능 국어 1등급을 달성할 수 있다고 믿었습니다.
이 레포는 저희의 과정과 결과를 보여주는 레포입니다.

## Result
아무 프롬프트 엔지니어링 없는 GPT-4는 23수능 국어(화작) 86점, 3등급이었습니다.
프롬프트 엔지니어링을 통해 GPT-4의 성적을 96점, 1등급까지 끌어 올렸습니다.
GPT-4가 내놓은 전체 정답과 풀이는 ```result/2023_11_KICE_top_p_zero_lll.txt```에 있습니다.

## Methods
### 1. 프롬프트 엔지니어링

수능 국어 GPT를 만들 때, 가장 쉽게 떠올릴 수 있는 것은 기출 문제를 활용한 fine-tune입니다. 
그러나 GPT-4가 이미 zero-shot 성능이 뛰어나다는 점, fine-tuning은 지식 학습보단 '말하는 방법'을 알려주는 것에 가까운 점, 시간과 돈, 데이터가 많이 필요하다는 점 때문에 제외했습니다.

여러번 실험한 결과, GPT-4는 수능 국어 문제를 '어떻게' 푸는지 잘 몰랐습니다.
그래서 저희는 수능 국어 문제를 푸는 방법을 알려주고자 하였습니다. 

장황하게 문제 해결 방법을 알려주는 것 보다는, 지문의 특정 문장을 참고하여 선택지 중에 정답을 고르도록 알려주는 것이 제일 좋은 성능을 보였습니다.
군더더기가 있는 말이 들어갈 수록 hallucination 문제가 심해졌기에, CoT 기반의 최대한 *간단한* 프롬프트를 완성했습니다. 
아래 프롬프트가 대부분의 문제에 쓰인 프롬프트입니다.

```text
국어 시험 문제를 푸는 대한민국의 고3 수험생으로서 위의 요약을 바탕으로 다음 문제의 답을 구하세요.

문제를 풀이할 때, 반드시 지문을 참고하세요.
문제는 무조건 1개의 정답만 있습니다.
문제를 풀이할 때 모든 선택지들을 검토하세요.
모든 선택지마다 근거를 지문에서 찾아 설명하세요.

다음의 형식을 따라 답변하세요.
최종 정답: (최종 정답)
1번: (선택지 1번에 대한 답변) + "(지문 속 근거가 된 문장)"
2번: (선택지 2번에 대한 답변) + "(지문 속 근거가 된 문장)"
3번: (선택지 3번에 대한 답변) + "(지문 속 근거가 된 문장)"
4번: (선택지 4번에 대한 답변) + "(지문 속 근거가 된 문장)"
5번: (선택지 5번에 대한 답변) + "(지문 속 근거가 된 문장)"

지문:
{지문 내용}

이 문제는 아래와 같이 <보기>가 주어져 있습니다. 
문제의 각 선택지들을 해결하기 위한 배경 지식을 설명해 주고 있는 것이 <보기>로써, 
각 선택지들을 지문과 연결시키고, <보기>의 지식을 활용하면 각 선택지의 참과 거짓을 판단할 수 있습니다.
문제를 해결할 때, 반드시 <보기>의 내용을 이용해서 문제를 해결해야 합니다.
<보기> :
{보기 내용}

질문 :
{질문 내용}

선택지 :
1번 - {1번 내용}
2번 - {2번 내용}
3번 - {3번 내용}
4번 - {4번 내용}
5번 - {5번 내용}
```

해당 프롬프트를 사용하면, 2등급까지는 큰 문제없이 도달할 수 있습니다.

### 2. 빈출 유형 대응 프롬프트
GPT-4가 '동음이의어', '다의어' 관련 문제를 굉장히 못 푸는 것을 확인했습니다. 

이는 해당 문제 유형에 대한 경험이 *전혀* 없다는 것을 감안하여, 맞춤 프롬프트를 제작하기로 했습니다.

GPT-4가 *문맥적으로* 비슷한 단어를 판단하도록 하려면, 해당 단어(동사)의 목적어를 비교할 수 있어야 합니다.
또한, 목적어가 실제적인 단어인지, 추상적인 단어인지도 논리적으로 분류할 수 있어야 합니다. 

해당 논리적 구조를 따라가게 하기 위하여, few-shot 및 CoT를 접목한 프롬프트를 작성했습니다.

```text
당신은 국어 시험 문제를 푸는 대한민국의 고3 수험생으로서 최종 정답을 고르시오.

'지문 속 목적어의 성격'과 '선택지 속 목적어의 성격'이 서로 같은 선택지를 1개만 고르세요.
모두 같은 선택지는 무조건 1개만 존재합니다.

문제를 풀이할 때 5개의 모든 선택지를 검토하세요.

자료나 돈처럼 실제 손으로 만질 수 있는 것은 '실제적인 단어'입니다.
관심, 집중, 인기, 이론처럼, 실제 손으로 만질 수 없는 것은 '추상적인 단어'입니다.

다음의 형식대로만 답변하세요.
최종 정답: (지문 속 목적어와 선택지 속 목적어의 성격이 서로 같은 선택지는 "(최종 정답)"입니다.
1번: - 지문 속 동사ⓐ의 목적어: "(목적어)" + 지문 속 목적어의 성격 : "(실제적인 단어 or 추상적인 단어)"
     - 선택지 속 동사ⓐ의 목적어: "(목적어)" + 선택지 속 목적어의 성격 : "(실제적인 단어 or 추상적인 단어)"
2번: - 지문 속 동사ⓑ의 목적어: "(목적어)" + 지문 속 목적어의 성격 : "(실제적인 단어 or 추상적인 단어)"
     - 선택지 속 동사ⓑ의 목적어: "(목적어)" + 선택지 속 목적어의 성격 : "(실제적인 단어 or 추상적인 단어)"
3번: - 지문 속 동사ⓒ의 목적어: "(목적어)" + 지문 속 목적어의 성격 : "(실제적인 단어 or 추상적인 단어)"
     - 선택지 속 동사ⓒ의 목적어: "(목적어)" + 선택지 속 목적어의 성격 : "(실제적인 단어 or 추상적인 단어)"
4번: - 지문 속 동사ⓓ의 목적어: "(목적어)" + 지문 속 목적어의 성격 : "(실제적인 단어 or 추상적인 단어)"
     - 선택지 속 동사ⓓ의 목적어: "(목적어)" + 선택지 속 목적어의 성격 : "(실제적인 단어 or 추상적인 단어)"
5번: - 지문 속 동사ⓔ의 목적어: "(목적어)" + 지문 속 목적어의 성격 : "(실제적인 단어 or 추상적인 단어)"
     - 선택지 속 동사ⓔ의 목적어: "(목적어)" + 선택지 속 목적어의 성격 : "(실제적인 단어 or 추상적인 단어)"
     
질문 :
{질문 내용}

선택지 :
1번 - {1번 내용}
2번 - {2번 내용}
3번 - {3번 내용}
4번 - {4번 내용}
5번 - {5번 내용}
```

## How to use
아래 코드로 해당 레포를 clone합니다.
```bash
git clone https://github.com/PCEO-AI-CLUB/KICE_slayer_AI_Korean.git
```
그 후, ```.env.template``` 파일을 참고하여 ```.env```파일을 작성합니다. *openai API key가 필요합니다.*

요구되는 라이브러리를 설치합니다.
```bash
pip install -r requirements.txt
```

마지막으로, ```main.py```를 실행합니다.
```bash
python main.py --test_file=./data/2023_11_KICE.json --save_path=./result/your_result.txt
```
top_p가 0이어도 GPT-4의 특성상 결과값이 변할 수 있어 1등급을 달성하지 못할 수도 있다는 점 주의 부탁드립니다.

## Who made this?
이 프로젝트는 포스텍영재기업인교육원 내 AI 동아리인 PCEO-AI-CLUB(지도교수 : (주)마커 정철현 박사)에서 진행했습니다. 저희는 보안 위협과 환각 증세가 없는 Document QA 인공지능 [KoPrivateGPT](https://github.com/PCEO-AI-CLUB/KoPrivateGPT) 프로젝트도 만들고 있습니다.

## Appendix
### 23 수능 오답 풀이
2023 수능 국어(화작)에서 15번(비문학)과 40번(화법과 작문) 문제를 GPT-4가 풀지 못했습니다. 왜 오답을 뱉어냈는지 나름대로 설명 해보는 섹션입니다.

#### 15번 문제
15번 문제의 핵심은 지문으로부터 '100^0.75'와 '1^0.75'를 유도해 무엇이 더 큰지를 구해야 합니다.
이는 GPT-4의 수학 능력 부족으로 두 숫자 중 더 큰 수 찾기를 힘들어 합니다.

또한, 지문만 보고 해당 식을 유도하는 것 조차도 힘들어 합니다. 
수학적 수식을 이해하고 그것을 선택지에 응용하는 능력이 떨어지기 때문입니다.
비슷한 문제로, 문제의 19년도 수능 31번 문제도 '만유인력 공식'을 이해하고 활용해야 풀 수 있는데, 해당 문제 역시 GPT-4는 못 풀었습니다. 

#### 40번 문제
40번에서는 학생 1과 학생 3 '**모두**' 상대의 발화 내용을 잘못 이해했는지 파악하는 것이 핵심입니다. 
실제로 해당 부분에서 학생 1은 상대의 발화 내용을 잘못 이해하고 있으나, 학생 3은 그렇지 않습니다. 
'학생 1과 학생 3 모두'를 AND 조건으로 파악하고, 학생 3은 상대의 발화 내용을 잘못 이해하고 있지 않다는 것을 파악해야 하는데,
GPT-4는 이러한 AND 조건을 파악하기 힘들어 합니다. 
어떠한 프롬프트를 써도 성공하지 못했습니다.
GPT-4는 학생 1만 확인하고 학생 3까지도 상대의 발화 내용을 이해하고 있다고 판단하며, 해당 부분에서 decomposition 능력이 부족합니다.
